# Приложение Wine Chat

## Обзор

Это веб-приложение предназначено для предоставления информации о российских винах. Пользователи могут взаимодействовать с приложением через чат-интерфейс, задавая вопросы о различных винах и получая ответы, сгенерированные AI-ассистентом. Ассистент использует локальную базу данных SQLite, содержащую рейтинги вин, для ответа на запросы пользователей.

## Пример чата

Вы: выведи подробный список вин Дзитоев

Бот:

 Вот подробный список вин производителя Константина Дзитоева:

1. **КД Ркацители**
   - Год: 2021
   - Рейтинг: 88
   - Балл: 5
   - Страница: 46

2. **КД Ркацители магнум**
   - Год: 2021
   - Рейтинг: 88
   - Балл: 5
   - Страница: 46

3. **КД брют розе 6**
   - Год: 2023
...

Вы: у какого производителя больше всего вин рейтинга 90 и выше?

Бот:

 У производителя "Винодельня Esse" больше всего вин с рейтингом 90 и выше — их количество составляет 6.

### возможные вопросы:

- Сколько вин рейтинга 90 и выше у производителя Абрау?
- У какого производителя самый большой средний рейтинг
- Из какого региона больше всего вин с рейтингом 90 и выше?
- Выведи 10 лучших вин по рейтингу из региона Крым

## Установка

1. **Клонируйте репозиторий:**
    ```sh
    git clone https://github.com/dperov/wine-chat.git
    cd wine-chat
    ```

2. **Настройте виртуальное окружение:**
    ```sh
    python -m venv env
    source env/Scripts/activate  # На Windows
    # source env/bin/activate    # На Unix или MacOS
    ```

3. **Установите необходимые зависимости:**
    ```sh
    pip install -r requirements.txt
    ```

4. **Настройте переменные окружения:**
    Создайте файл .env в корневом каталоге со следующим содержимым:
    ```properties
    OPENAI_API_KEY="your_openai_api_key"
    ```
5. Если вы работаете из России, вам потребуется VPN или SOCKS-прокси. В случае SOCKS-прокси настройте переменные окружения HTTPS_PROXY, HTTP_PROXY, например добвьте в файл .env строки:
    ```properties
    HTTPS_PROXY="socks5://127.0.0.1:1088"
    HTTP_PROXY="socks5://127.0.0.1:1088"
    ```

## Использование

1. **Запустите Flask-приложение:**
    ```sh
    python wine_chat.py
    ```

2. **Откройте приложение:**
    Откройте веб-браузер и перейдите по адресу `http://127.0.0.1:5000`.

3. **Взаимодействуйте с чатом:**
    - Введите ваше сообщение в поле ввода и нажмите "Отправить" или нажмите "Enter".
    - Ассистент ответит информацией о российских винах на основе данных в базе данных SQLite.

## Файлы

- **`wine_chat.py`**: Основной файл приложения Flask.
- **`assistant.py`**: Содержит логику для взаимодействия с OpenAI API.
- **`execute_sql.py`**: Скрипт для загрузки данных из CSV в базу данных SQLite и выполнения SQL-запросов.
- **`templates/index.html`**: HTML-шаблон для интерфейса чата.
- **`data.csv`**: CSV-файл, содержащий данные о рейтингах вин.

## Примечания

- Убедитесь, что у вас есть действующий ключ API OpenAI и установите его в файле .env.

